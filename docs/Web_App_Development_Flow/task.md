# Webアプリ開発タスク: JSTQB再現問題演習アプリ

- [x] **1. 企画・要件定義** <!-- id: 0 -->
  - [x] アプリコンセプト決定 (JSTQB CBT模試再現)
  - [x] 要件定義書 (`requirements.md`) 作成・整合

- [x] **2. 設計・環境構築** <!-- id: 4 -->
  - [x] React (Vite) + Node.js 環境セットアップ
  - [x] 技術スタック選定

- [x] **3. UI実装 & データ連携** <!-- id: 12 -->
  - [x] CSVデータ読み込み (StartScreenへ移動)
  - [x] JSTQB風 UIデザイン実装
  - [x] 「後で見直す」フラグ機能追加

- [x] **4. 機能実装** <!-- id: 50 -->
  - [x] **Step 4-0: スタート画面の実装** <!-- id: 55 -->
    - [x] CSV読み込み画面 (デフォルトロード/ファイルアップロード)
    - [x] モード選択画面 (一問一答/模試)
    - [x] 画面遷移制御 (スタート → 問題画面)
  - [x] **Step 4-1: 一問一答モード (解説機能)** <!-- id: 51 -->
    - [x] 解説表示用のステート管理 (`showFeedback`)
    - [x] 解説画面のUI実装 (正誤、解説文)
    - [x] 「次へ」ボタンの挙動変更 (回答 -> 解説 -> 次の問題)
    - [x] UI調整: フラグ・問題選択の無効化
  - [x] **Step 4-2: 本番模試モード (結果画面)** <!-- id: 52 -->
    - [x] 終了判定ロジックの実装（最後の問題で「終了」→ 結果画面）
    - [x] 結果画面コンポーネント (`ResultScreen`) の作成
    - [x] 解説ポップアップ（正誤ハイライト付き）の実装
    - [x] 経過時間・超過表示の実装
  - [x] **Step 4-3: 問題選択機能** <!-- id: 53 -->
    - [x] 問題一覧ポップアップのUI実装
    - [x] 各問題のステータス表示（未回答/回答済/フラグ）
    - [x] ジャンプ機能の実装
  - [x] **Step 4-4: タイマー機能** <!-- id: 54 -->
    - [x] タイマー状態管理 (残り時間, ポーズ状態)
    - [x] ヘッダーへの表示 (MM:SS)
    - [x] タイムアップ時の挙動 (ダイアログ, 継続/終了)
    - [x] 結果画面での経過時間表示
    - [x] 一問一答モードでの一時停止機能

## Phase 5: リファクタリングと保守

- [x] **リファクタリング**
  - [x] `useExamTimer` フックの抽出
  - [x] `QuestionListModal`, `ExplanationModal` のコンポーネント化
  - [x] `theme.js` による定数管理
- [x] **バグ修正**
  - [x] リファクタリング後のホワイトスクリーン修正
  - [x] 結果画面でタイマーが止まらないバグ修正
  - [x] タイムアップ時のダイアログ競合による誤超過判定の修正
- [x] **UI改善**
  - [x] 結果画面の「問題文」列の削除 (要望対応)
  - [x] 結果画面の「回答/正解」列の削除 (要望対応)
  - [x] 結果一覧のグリッド（タイル）表示化 (要望対応)
  - [x] ヘッダー・フッターのレイアウト調整
  - [x] 問題選択画面のリデザイン (3列リスト形式)
  - [x] 結果画面のリデザイン (3列リスト形式 + フラグ表示)
  - [x] 結果画面のリデザイン (3列リスト形式 + フラグ表示)
  - [x] 本番模試モード終了時の確認ダイアログ追加
  - [x] 終了確認をカスタムモーダル化 (タイマー継続のため)
  - [x] アプリタイトル変更 ("CBT 再現演習")
  - [x] モーダル共通化 (確認・警告・時間切れ)
  - [x] 時間切れ即終了時の超過判定回避
  - [x] 制限時間の上限を9999分に変更

- [ ] **5. 公開準備/品質向上** <!-- id: 16 -->
  - (今後のタスク)

## Phase 6: 弱点克服機能

- [x] **実装計画**
  - [x] 要件定義書 (`requirements.md`) の更新
  - [x] 実装計画書 (`implementation_plan.md`) の作成

- [x] **Step 6-1: フラグ機能の拡張**
  - [x] 一問一答モードでのフラグアイコン有効化 (`App.jsx`, `InfoPanel.jsx`)
  - [x] モード間でのフラグ状態の維持確認

- [x] **Step 6-2: 結果画面の更新**
  - [x] `ResultScreen.jsx` でフラグアイコンをクリック/切替可能にする
  - [x] `ResultScreen` に `toggleReviewFlag` 関数を渡す

- [x] **Step 6-3: CSVエクスポート機能**
  - [x] CSV生成ロジックの実装 (不正解/フラグでフィルタリング)
  - [x] `ResultScreen` に「復習用CSVエクスポート」ボタンを追加
  - [x] エクスポートされたCSVが正常に再インポートできるか検証

## Phase 7: リファインメント (改善)

- [x] **Step 7-1: CSVからID列を削除**
  - [x] `StartScreen.jsx` を更新し、インポート時にIDを自動生成
  - [x] `ResultScreen.jsx` を更新し、エクスポートからIDを除外
  - [x] `public/questions.csv` を更新し、ID列を削除

- [x] **Step 7-2: プロジェクト構成のリファクタリング**
  - [x] `docs` ディレクトリをプロジェクトルートに移動
  - [x] 開発スクリプト用 `.venv` の作成

- [x] **Step 7-3: CSVテンプレートダウンロード機能**
  - [x] `StartScreen.jsx` にデフォルトCSVのダウンロードリンクを追加

- [x] **Step 7-4: デフォルト問題の更新**
  - [x] PDFから追加問題を抽出・翻訳
  - [x] `public/questions.csv` を更新
  - [x] フィードバック対応（問6削除、ID列完全削除）
